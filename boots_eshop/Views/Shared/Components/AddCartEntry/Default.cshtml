@model BootEshop.ViewModels.AddCartEntryViewModel
<script>
    window.productId = @Model.ProductId.ToString()
</script>
<form id="addCartForm"
      asp-action="Add"
      asp-controller="Cart"
      method="post">
<div class="add-cart-entry">
    <!-- Quantity -->
    <div class="field">
        <label for="quantity">Quantity</label>
        <input type="number"
               id="quantity"
               name="Quantity"
               min="1"
               value="@Model.Quantity"
               class="form-control" />
    </div>

    <input type="hidden" asp-for="ProductId" />

     <div class="d-flex flex-column justify-content-between gap-2">
                <!-- COLORS -->
                <div class="field ">
                    <span>Colors</span>
                    <div class="options d-flex flex-row gap-2">
                        @foreach (var color in Model.Variants.Select(v => v.Color).Distinct())
                        {
                            <label class="color-wrapper @(color.Id == Model.SelectedColorId ? "border-color-accent" : "border-color-light")"
                                   style="background-color:@color.HexColor">
                                <input type="radio"
                                       class="invisible"
                                       name="SelectedColorId"
                                       value="@color.Id"
                                       @(color.Id == Model.SelectedColorId ? "checked" : "")/>
                            </label>
                        }
                    </div>
            
                </div>
                <!-- Sizes as radios -->
                <div class="field">
                    <span >Size</span>
                    <div class="options d-flex flex-row gap-2" id="sizeOptions">
                        @foreach (var size in Model.Variants.Select(v => v.Size).Distinct())
                        {

                            <label class="option">
                                @if (Model.SelectedColorId is { } selectedColorId && Model.Variants.Where(v => v.Size == size).Select(v => v.Color.Id).Contains(selectedColorId))
                                {
                                    <input type="radio" name="SelectedSizeId" value="@size.Id" class="color-selector"/>
                                    <span class="color-primary">@size.Size</span>
                                }
                                else
                                {
                                    <input type="radio" name="SelectedSizeId" value="@size.Id" disabled="disabled"/>
                                    <span class="color-accent">@size.Size</span>
                                }
                            </label>
                        }
                    </div>
                </div>
            </div>


    <!-- Actions -->
    <div class="actions">
        <button type="submit" class="btn btn-primary">OK</button>
        <button type="button" class="btn btn-secondary" onclick="closeAddCart()">Cancel</button>
    </div>
</div>
</form>


